<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scope o Àmbit</title>
</head>
<body>
    <p>
        <a href="../index.html">Anar a l'índex</a>
    </p>

    <h1>
        Scope o Àmbit
    </h1>

    <p>
        El <strong>scope</strong> (o abast) fa referència a on es pot accedir a una variable dins del teu codi. A JavaScript, hi ha dos grans tipus d’abast: <strong>global</strong> i <strong>local</strong>.
    </p>

    <h2>
        Principi del menor accés
    </h2>
   
    <p>
        En programació, és bona pràctica seguir el <strong>principi del menor accés</strong> (o <em>least privilege</em>): això vol dir que les variables s’han de declarar només allà on es necessiten. Si una variable només s’usa dins d’una funció o un bloc, no s’hauria de declarar fora d’aquest àmbit.
    </p>

    <p>
        Això ajuda a fer el codi més segur, més fàcil d'entendre i evita errors inesperats, com sobreescriure variables sense voler. A més, evita “contaminar” l’espai global amb variables que no cal que siguin visibles arreu.
    </p>

    <h2>
        Com decideix JS quina variable agafar?
    </h2>
    
    <p>
        Quan JavaScript troba una variable, comença buscant-la des de dins cap enfora: primer mira si està dins del mateix bloc o funció, després puja al bloc exterior, i així successivament fins arribar al scope global. Si no la troba, dona error.
    </p>

    <pre>
        <code>
            let nom = "Anna"; // Scope global

            function saludar() {
                let nom = "Joan"; // Scope local, oculta la global
                console.log(nom); // Mostra "Joan", perquè troba aquesta abans
            }

            saludar();
            console.log(nom); // Mostra "Anna", la global
                
        </code>
    </pre>

    <h2>
        Scope global
    </h2>
    
    <p>
        Una variable té abast global quan es declara fora de qualsevol funció o bloc. Això vol dir que es pot accedir a ella des de qualsevol lloc del programa.
    </p>

    <pre>
        <code>
            // Variable global
            let missatge = "Hola, món!";

            function saludar() {
                console.log(missatge); // Pot accedir-hi perquè és global
            }

            saludar();
            console.log(missatge); // També aquí
        </code>
    </pre>

    <h2>
        Scope local
    </h2>
   
    <p>
        Una variable és local quan es declara dins d’una funció o bloc amb <code>let</code> o <code>const</code>. Només es pot fer servir dins d’aquest bloc.
    </p>

    <pre>
        <code>
            function provaLocal() {
                let secret = "Només dins la funció";
                console.log(secret); // Correcte
            }

            provaLocal();
            // console.log(secret); // Error! No existeix fora de la funció
        </code>
    </pre>

    <h2>
        Scope dins de blocs (if, for...)
    </h2>
   
    <p>
        Amb <code>let</code> i <code>const</code>, les variables també tenen scope limitat dins dels blocs (com els <code>if</code> o <code>for</code>).
    </p>

    <pre>
        <code>
            if (true) {
                let bloc = "Estic dins d’un bloc";
                console.log(bloc); // Funciona
            }

            // console.log(bloc); // Error! Fora del bloc
        </code>
    </pre>

    <h2>
        Exemple amb conflicte entre scopes
    </h2>
    
    <p>
        Si declares una variable local amb el mateix nom que una global, la local "oculta" la global dins del seu àmbit.
    </p>

    <pre>
        <code>
            let nom = "Anna";

            function mostrarNom() {
                let nom = "Joan"; // Aquesta variable només existeix aquí
                console.log(nom); // Mostra "Joan"
            }

            mostrarNom();
            console.log(nom); // Mostra "Anna"
        </code>
    </pre>

    <h2>
        Conclusió
    </h2>
    
    <p>
        Entendre bé el <strong>scope</strong> és essencial per evitar errors i conflictes. Sempre que puguis, utilitza variables locals dins de funcions per evitar modificar variables globals accidentalment.
    </p>

    <p>
        <a href="../index.html">Anar a l'índex</a>
    </p>  
</body>
</html>