<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>First class objects</title>
</head>
<body>
    <p>
        <a href="../index.html">Anar a l'√≠ndex</a>
    </p>

    <h1>First class objects</h1>

    <p>
        Les funcions es poden tractar com qualsevol altra dada a JavaScript, es poden guardar, passar i retornar com si fos un n√∫mero o un text.
    </p>

    <p>
        En JavaScript, les funcions s√≥n com caixes que es poden moure:      
    </p>

    <ul>
        <li>Es poden guardar en una variable</li>
        <li>Es poden enviar a una altra funci√≥</li>
        <li>Es poden retornar com a resultat</li>
    </ul>
    
    <p>
        √âs com si una funci√≥ fos un objecte m√©s. Per aix√≤ diem que s√≥n "objectes de primera classe" (first-class objects).
    </p>

    <h2>
        Guardar funcions en una variable
    </h2>

    <p>
        L'exemple m√©s senzill √©s guardar una funci√≥ en una variable. Un cop assignem la funci√≥ (sense executar-la) a la variable, podem executar la funci√≥ des de la variable posant el nom de la variable i els dos par√®ntesis.  
    </p>

    <pre>
        <code>
            function hola() {
            console.log("Hola!");
            }

            let direccio = hola;   // Guardem la funci√≥ a dins d'una variable
            direccio();            // Executem la funci√≥ des de la variable amb el nom de la variable i els dos par√®ntesis!
        </code>
    </pre>
    
    <p>
        Si executem el codi anterior, veurem que s'imprimeix "Hola!" per la consola.
    </p>
    
    <p>
        Quina avantatge ens d√≥na? Podem executar la funci√≥ quan vulguem cridant la variable a la qual li hem assignat la funci√≥. Imagineu que tenim la tenim una funci√≥ que fa una cosa molt espec√≠fica, i que volem executar-la en diferents moments del nostre codi. Podem guardar la funci√≥ en una variable i executar-la quan vulguem, sense necessitat de tornar a escriure la funci√≥. Aix√≤ ens fa el codi m√©s llegible i m√©s f√†cil de mantenir.
    </p>

    <pre>
        <code>
            function hola() {
            console.log("Hola!");
            }

            let direccio = hola;   // Guardem la funci√≥ a dins d'una variable
            direccio();            // Executem la funci√≥ des de la variable UNA VEGDA
            direccio();            // Executem la funci√≥ des de la variable ALTRA VEGADA
            direccio();            // Executem la funci√≥ des de la variable UNA TERCERA VEGADA
        </code>
    </pre>

       
    <p>
        Perqu√® fem <code>let direccio = hola;</code> i no fem <code>let direccio = hola();</code>;?
    </p>

    <p>
        La resposta √©s √©s que <code>hola</code> √©s una funci√≥, mentre que <code>hola()</code> √©s el resultat d'executar-la. Si fem <code>let direccio = hola();</code>, la variable <code>direccio</code> tindr√† el valor <code>undefined</code> (ja que la funci√≥ no retorna res), i no podrem executar-la m√©s tard amb <code>direccio();</code>.
    </p>
    
    <p>
        Com que les analogies ens ajuden a entendre el que estem fent, podem guardar la funci√≥ com si fos una recepta de cuina. La recepta ens diu com fer una cosa, per√≤ no el plat. Per fer el plat, hem de seguir la recepta. En aquest cas, la recepta √©s la funci√≥, i seguir-la √©s executar-la quantes vegades vulguem al llarg de la setmana.
    </p>

    <h2>
        Passar funcions com a arguments
    </h2>
    
    <p>
        Passar una funci√≥ com a argument a una funci√≥ √©s enviar una funci√≥ a una altra funci√≥ com si fos un n√∫mero o un text. √âs com donar una nota amb instruccions perqu√® alg√∫ altre l‚Äôexecuti!
    </p>

    <pre>
        <code>
            function saluda() {
            console.log("Hola!");
            }

            function executar(funcio) {
            funcio(); // cridem la funci√≥ que ens han passat
            }

            executar(saluda);
        </code>
    </pre>

    <p>
        saluda √©s una funci√≥ que imprimeix "Hola!", executar √©s una funci√≥ que rep una altra funci√≥, Li passem la funci√≥ saluda com a argument, i dins executar, fem que la funci√≥ rebuda s‚Äôexecuti. Podem passar una funci√≥ com a argument com si fos una dada, i l‚Äôaltra funci√≥ la pot executar.
    </p>

    <p>
        Per qu√® ens pot passar una funci√≥ com a argument? Perqu√® ens permet fer codi m√©s flexible i reutilitzable. Podem decidir qu√® fer en cada moment, i una altra funci√≥ s‚Äôencarrega de quan fer-ho. Imagina que volem fer alguna cosa despr√©s de fer clic a un bot√≥. 
    </p>

    <p>
        El codi per fer-ho a JavaScript
    </p>
        
    <pre>
        <code>
            button.addEventListener("click", saluda);
        </code>
    </pre>

    <p>
        Estem dient al navegador: ‚ÄúQuan alg√∫ faci clic al bot√≥‚Ä¶‚Äù ‚Äú‚Ä¶executa la funci√≥ saluda.‚Äù Li passem la funci√≥ com a argument, i el navegador l‚Äôexecutar√† m√©s endavant, quan calgui.
    </p>

    <h3>
        Fes clic al bot√≥
    </h3>
    
    <button id="meuBoto">
        Clica'm!
    </button>

    <script>
        // Definim la funci√≥
        function saluda() {
        alert("Hola! Has fet clic!");
        }

        // Busquem el bot√≥ i li passem la funci√≥ com a argument
        let boto = document.getElementById("meuBoto");
        boto.addEventListener("click", saluda);
    </script>

    <p>
        Aqui teniu el codi que ho fa possible:  
    </p>

    <pre>
            <code>  
            &lt;h3>                                             // √©s una etiqueta h2 d'obertura
                Fes clic al bot√≥                                // el text
            &lt;/h3>                                            // √©s una etiqueta h2 de tancament
    
            &lt;button id="meuBoto">                            // Posem un atribut identifier a la etiqueta d'obertura del button que genera el bot√≥ per poder-lo trobar. 
                Clica'm!                                        // el text del bot√≥
            &lt;/button>                                        // tanquem l'etiqueta 

            &lt;script>                                         // Definim el codi JavaScript dins de la etiqueta script
                // Definim la funci√≥
                function saluda() {
                alert("Hola! Has fet clic!");                   // Imprimim un missatge per pantalla
                }

                
                let boto = document.getElementById("meuBoto");  // Agafem el bot√≥ al document pel seu id i li passem la funci√≥ com a argument
                boto.addEventListener("click", saluda);         // el bot√≥ li passem la funci√≥ saluda com a argument a la funcio addeventListener
            &lt;/script>                                        // tanquem el codi JavaScript amb la etiqueta script
        </code>
    </pre>

    <h2>
        Retornar una funci√≥ des d'una altra funci√≥
    </h2>

    <p>
        Una funci√≥ pot crear i retornar una altra funci√≥. Aix√≤ ens permet preparar "funcions a mida".
    </p>

    <h3>
        exemple general
    </h3>

    <pre>
        <code>
            function creaMissatge() {
                return function () {
                    console.log("Hola!");
                };
            }
            
            let funcioNova = creaMissatge(); // ens retorna una nova funci√≥
            funcioNova(); // mostra "Hola!"   
        </code>
    </pre>

    <p>
        creaMissatge() no mostra res directament. Aquesta funci√≥ retorna una altra funci√≥, que mostra "Hola!" (amb return function () { ... }). Guardem aquesta nova funci√≥ a funcioNova. Despr√©s, la cridem amb funcioNova()
    </p>

    <p>
        Encara les podem fer m√©s utils si hi posem par√†metres.
    </p>

    <pre>
        <code>
            function creaMissatge(text) {
                return function () {
                    console.log(text);
                };
            }

            let hola = creaMissatge("Hola!");
            let ad√©u = creaMissatge("Fins aviat!");

            hola();   // Hola!
            ad√©u();   // Fins aviat!
        </code>
    </pre>

    <h2>
        Conclusions
    </h2>
    
    <p>
        En JavaScript, les funcions es poden tractar com si fossin dades i obre moltes possibilitats!: es poden guardar, passar i retornar. Guardar una funci√≥ en una variable, passar una funci√≥ com a argument a una altra funci√≥, retornar una funci√≥ des d'una altra funci√≥... En aquest cas, les funcions s√≥n objectes de primera classe. Aquesta caracter√≠stica ens permet escriure codi m√©s flexible, modular i reutilitzable. M√©s endavant veurem que aix√≤ √©s essencial per: Fer callbacks (funcions que es criden despr√©s d'una acci√≥), Fer servir addEventListener, setTimeout, map, filter, etc., Treballar amb funcions as√≠ncrones i promeses.
    </p>

    <h2>
        Exercicis
    </h2>

    <!-- Exercici 1 -->
    <p>1Ô∏è‚É£ 
        Crea una funci√≥ que digui "Hola!" i guarda-la en una variable. Executa-la.
    </p>
    
    <button onclick="mostrarSolucio('solucio1')">
        Mostra / Amaga soluci√≥
    </button>
    
    <pre id="solucio1" style="display:none;">
        <code>
            let saluda = function() {
                console.log("Hola!");
            };

            saluda(); // Mostra "Hola!"
        </code>
    </pre>

    <!-- Exercici 2 -->
    <p>
        2Ô∏è‚É£ Crea una funci√≥ <code>saludaNom</code> que rebi un nom i imprimeixi ‚ÄúHola, [nom]!‚Äù
    </p>
    <button onclick="mostrarSolucio('solucio2')">
        Mostra / Amaga soluci√≥
    </button>
    
    <pre id="solucio2" style="display:none;">
        <code>
            function saludaNom(nom) {
                console.log("Hola, " + nom + "!");
            }

            saludaNom("Pau");
        </code>
    </pre>

    <!-- Exercici 3 -->
    <p>
        3Ô∏è‚É£ Crea una funci√≥ que rebi un n√∫mero i retorni el doble. Mostra el resultat amb <code>console.log</code>.
    </p>
    
    <button onclick="mostrarSolucio('solucio3')">
        Mostra / Amaga soluci√≥
    </button>
    
    <pre id="solucio3" style="display:none;">
        <code>
            function doble(num) {
                return num * 2;
            }

            console.log(doble(4)); // 8
        </code>
    </pre>

    <!-- Exercici 4 -->
    <p>
        4Ô∏è‚É£ Fes una funci√≥ que rebi dos n√∫meros i retorni la seva mitjana.
    </p>
    
    <button onclick="mostrarSolucio('solucio4')">
        Mostra / Amaga soluci√≥
    </button>
    
    <pre id="solucio4" style="display:none;">
        <code>
            function mitjana(a, b) {
                return (a + b) / 2;
            }

            console.log(mitjana(7, 9)); // 8
        </code>
    </pre>

    <!-- Exercici 5 -->
    <p>
        5Ô∏è‚É£ Crea una funci√≥ que rebi una edat i retorni "Ets major d‚Äôedat" si t√© 18 o m√©s, si no ‚ÄúEts menor‚Äù.
    </p>
    
    <button onclick="mostrarSolucio('solucio5')">
        Mostra / Amaga soluci√≥
    </button>
    
    <pre id="solucio5" style="display:none;">
        <code>
            function comprovaEdat(edat) {
                if (edat >= 18) {
                    return "Ets major d‚Äôedat";
                } else {
                    return "Ets menor";
                }
            }

        console.log(comprovaEdat(17)); // "Ets menor"
        </code>
    </pre>

    <!-- Exercici 6 -->
    <p>
        6Ô∏è‚É£ Demana el nom amb <code>prompt</code> i passa‚Äôl a una funci√≥ que el posi en maj√∫scules i el torni.
    </p>
    
    <button onclick="mostrarSolucio('solucio6')">
        Mostra / Amaga soluci√≥
    </button>
    
    <pre id="solucio6" style="display:none;">
        <code>
            function majuscules(nom) {
                return nom.toUpperCase();
            }

            let nomUsuari = prompt("Com et dius?");
            console.log(majuscules(nomUsuari));
        </code>
    </pre>

    <!-- Exercici 7 -->
    <p>
        7Ô∏è‚É£ Fes una funci√≥ que rebi quantes hores passes amb videojocs i s√®ries, i torni un "nivell de friquisme" (text).
    </p>
    
    <button onclick="mostrarSolucio('solucio7')">
        Mostra / Amaga soluci√≥
    </button>
    
    <pre id="solucio7" style="display:none;">
        <code>
            function nivellFriqui(videojocs, series) {
                let total = videojocs + series;
                if (total > 8) return "Ets mega friqui üòÖ";
                if (total > 4) return "Friqui moderat üòé";
                return "Molt equilibrat üëç";
            }

            console.log(nivellFriqui(3, 2)); // "Friqui moderat üòé"
        </code>
    </pre>

    <!-- Exercici 8 -->
    <p>
        8Ô∏è‚É£ Escriu una funci√≥ <code>missatgeDia</code> que rebi el dia de la setmana i retorni un missatge diferent.
    </p>
    
    <button onclick="mostrarSolucio('solucio8')">
        Mostra / Amaga soluci√≥
    </button>
    
    <pre id="solucio8" style="display:none;">
        <code>
            function missatgeDia(dia) {
                if (dia === "dilluns") return "√Änims! Comen√ßa la setmana!";
                if (dia === "divendres") return "Ja s'acosta el cap de setmana!";
                return "Un altre dia qualsevol!";
            }

            console.log(missatgeDia("divendres")); // "Ja s'acosta el cap de setmana!"
        </code>
    </pre>

    <!-- Exercici 9 -->
    <p>
        9Ô∏è‚É£ Fes una funci√≥ que calculi la nota final segons tres notes, i la guardi en una variable <code>notaFinal</code>.
    </p>
    
    <button onclick="mostrarSolucio('solucio9')">
        Mostra / Amaga soluci√≥
    </button>
    
    <pre id="solucio9" style="display:none;">
        <code>
            function calculaNota(n1, n2, n3) {
                return (n1 + n2 + n3) / 3;
            }

            let notaFinal = calculaNota(7, 8, 6);
            console.log("La nota final √©s: " + notaFinal);
        </code>
    </pre>

    <!-- Exercici 10 -->
    <p>
        üîü Demana l‚Äôany de naixement amb <code>prompt</code>, passa‚Äôl a una funci√≥ que retorni l‚Äôedat, i imprimeix-la.
    </p>
    
    <button onclick="mostrarSolucio('solucio10')">
        Mostra / Amaga soluci√≥
    </button>
    
    <pre id="solucio10" style="display:none;">
        <code>
            function calculaEdat(anyNaixement) {
                let actual = 2025;
                return actual - anyNaixement;
            }

            let any = Number(prompt("Quin any vas n√©ixer?"));
            console.log("Tens " + calculaEdat(any) + " anys.");
        </code>
    </pre>

    <script>
    /**
     * Mostra o amaga un bloc d'HTML identificat per l'ID donat.
     * Si el bloc est  amagat, el fa visible, i viceversa.
     * 
     * @param {string} id - L'ID del bloc d'HTML a mostrar o amagar.
     * @example
     *  // Mostra el bloc amb l'ID "solucio1"
     *  mostrarSolucio('solucio1');
     */
    function mostrarSolucio(id) {
        const bloc = document.getElementById(id);
        // Si el bloc est  amagat, el fa visible, i viceversa
        bloc.style.display = bloc.style.display === "none" ? "block" : "none";
    }
    </script>
        
    <p>
        <a href="../index.html">Anar a l'√≠ndex</a>
    </p>  
</body>
</html>